#include <cstdlib>
#include <iostream>
#include <string>





void qm_final(){


   TFile input("cu_pass0v7_ghp_022.root", "read");    
   
    TFile f("sol_pass0v7_ibnt_10_fits.root", "update");
   
   gStyle->SetOptStat("");
	gStyle->SetCanvasPreferGL();


double c = 300000000;

double hbar = 1.05 * pow(10,-34);

double v = 0.1;

double t = 3 * pow(10,-9); // fm

double m_pi = 140;
double m_rho = 770;

double ga = 1.25;
double f_pi = 132;
double g_pi = (pow(ga,2)*pow(m_pi,2))/(2*pow(f_pi,2));

double a_ar[200] = {0,
1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
13,
14,
15,
16,
17,
18,
19,
20,
21,
22,
23,
24,
25,
26,
27,
28,
29,
30,
31,
32,
33,
34,
35,
36,
37,
38,
39,
40,
41,
42,
43,
44,
45,
46,
47,
48,
49,
50,
51,
52,
53,
54,
55,
56,
57,
58,
59,
60,
61,
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76, 
77,
78,
79,
80,
81, 
82 , 
83  ,
84  ,
85  ,
86  ,
87  ,
88  ,
89  ,
90  ,
91 ,
92  ,
93  ,
94,
95 , 
96  ,
97  ,
98  ,
99  ,
100 ,
101 ,
102 ,
103 ,
104 ,
105 ,
106,
107 ,
108 ,
109 ,
110 ,
111 ,
112,
113,
114 ,
115 ,
116 ,
117 ,
118,
119 ,
120 ,
121 ,
122 ,
123 ,
124 ,
125 ,
126,
127 ,
128 ,
129 ,
130 ,
131 ,
132 ,
133 ,
134,
135 ,
136,
137 ,
138 ,
139 ,
140,
141,
142,
143,
144,
145 ,
146 ,
147 ,
148 ,
149 ,
150 ,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200};

double b_ar[200] = {0.000,
   62.08663,
   64.49054,
   64.68648,
   64.28440,
   63.66322,
   62.95443,
   62.21316,
   61.46508,
   60.72287,
   59.99289,
   59.27826,
  58.58034,
  57.89955,
  57.23574,
  56.58848,
  55.95719,
  55.34120,
  54.73982,
  54.15238,
  53.57819,
  53.01663,
  52.46707,
  51.92895,
  51.40173,
  50.88491,
  50.37800,
  49.88057,
  49.39220,
  48.91251,
  48.44112,
  47.97770,
  47.52193,
  47.07350,
  46.63214,
  46.19758,
  45.76956,
  45.34786,
  44.93224,
  44.52251,
  44.11845,
  43.71988,
  43.32663,
  42.93851,
  42.55538,
  42.17707,
  41.80345,
  41.43437,
  41.06970,
  40.70931,
  40.35309,
  40.00091,
  39.65268,
  39.30828,
  38.96761,
  38.63058,
  38.29709,
  37.9670,
  37.64039,
  37.31701,
  36.99684,
  36.67980,
  36.36583,
  36.05484,
  35.74677,
  35.44156,
  35.13915,
  34.83946,
  34.54245,
  34.24806,
  33.95623,
  33.66691,
  33.38005,
  33.09559,
  32.81350,
  32.53372,
  32.25621,
  31.98093,
  31.70783,
  31.43687,
  31.16802,
  30.90122,
  30.63646,
  30.37369,
  30.11287,
  29.85397,
  29.59695,
  29.34179,
  29.08846,
  28.83691,
  28.58713,
  28.33908,
  28.09274,
  27.84807,
  27.60505,
  27.36365,
  27.12386,
  26.88563,
  26.64896,
  26.41380,
 26.18015,
 25.94798,
 25.71727,
 25.48799,
 25.26012,
  25.03365,
 24.80855,
 24.58480,
 24.36239,
 24.14130,
 23.92150,
 23.70298,
 23.48572,
 23.26971,
 23.05492,
 22.84135,
 22.62897,
 22.41777,
 22.20773,
 21.99885,
 21.79109,
 21.58446,
 21.37893,
 21.17449,
 20.97113,
 20.76883,
 20.56759,
 20.36738,
 20.16820,
 19.97003,
 19.77286,
 19.57668,
 19.38148,
 19.18725,
 18.99396,
 18.80163,
 18.61022,
 18.41974,
 18.23016,
 18.04149,
 17.853711,
  17.66681,
 17.48079,
 17.29562,
 17.11131,
 16.92784,
 16.74520,
 16.56339,
 16.38239,
 16.20221,
 16.02282,
 15.84422,
 15.66640,
 15.48936,
 15.31309,
 15.13757,
 14.96281,
 14.78879,
 14.61550,
 14.44295,
 14.27111,
 14.09999,
 13.92958,
 13.75987,
 13.59085,
 13.42252,
 13.25487,
 13.08789,
 12.92158,
 12.75593,
 12.59094,
 12.42660,
 12.26290,
 12.09983,
 11.93740,
 11.77560,
 11.61441,
 11.45384,
 11.29388,
 11.13452,
 10.97576,
 10.81759,
 10.66001,
 10.50301,
 10.34659,
 10.19074,
 10.03546,
  9.88074,
  9.72658,
  9.57298,
  9.41992,
  9.26741,
  9.11543,
  8.96399,
  8.81308,
  8.66270,
  8.51284,
  8.36350,
  8.21467,
  8.06636,
  7.91854};


//still need (1/a) (s/2) g_rho  al  delta   


++

double r = abs(r1 - r2);

double k_func = -(1/a) + (r/2)*pow(k,2) + (s/2)*pow(k,4);

double v_func = -g_pi * ((exp(-m_pi * r))/(4*3.14159*r))  - g_rho * ((exp(-m_rho * r))/(4*3.14159*r))

double rl_func = al*exp(sqrt(-1) * delt) * (1/(k*r)) * sin((k*r) - ((l*3.14159)/2) + delt);

double der_rl_func = al*exp(sqrt(-1) * delt) * (2/(k*pow(r,3))) * -1 * pow(k,2) * sin((k*r) - ((l*3.14159)/2) + delt);

double B_l = (r/rl_func)*der_rl_func;



/*
    TH1F *vcu_hist = new TH1F("Sector 6 vx", "LD_{2} Inbending", 200, -30, 20);
       vcu_hist->SetStats(0);
       vcu_hist->SetLineColor(kGreen);
       vcu_hist->GetXaxis()->SetTitle("M_{#pi^{+}#pi^{-}} [GeV]");
   



  
      TH1F *cu_hist = (TH1F*)input22.Get(" vz"); 
      
      
      
      TCanvas *c3 = new TCanvas("c3","vz",0,0,640,480);
      vz_hist->Draw("HIST");
      vz1_hist->Draw("HIST Same");
      c3->BuildLegend();
      c3->Write();
      
     
  TF1 *g11 = new TF1 ("m11", "gaus", -10.0, -5);
  g11->SetLineColor(kRed);
  TF1 *g21 = new TF1 ("m21", "gaus", -5, -0.0);
  g21->SetLineColor(kGreen);
  TF1 *f11 = new TF1("double_gaus", "gaus(0) + gaus(3) + [6] + [7]*x", -10, 0.0);
  f11->SetParNames("Constant 1", "Mean 1", "Sigma 1",
                  "Constant 2", "Mean 2", "Sigma 2");
  f11->SetLineColor(kBlue);
  
  gStyle->SetOptFit(1);
  
  tvz1_hist->Fit(g11, "R");
  tvz1_hist->Fit(g21, "R+");
  
  Double_t par1[8];
  g11->GetParameters(&par1[0]);
  g21->GetParameters(&par1[3]);
  f11->SetParameters(par1);
  
  tvz1_hist->Fit(f11, "R+");
  // h->Fit(f1, "+", "e1", 4, 16);
  tvz1_hist->Draw("e1");
      tvz1_hist->Write();
      
  */    
  
}


